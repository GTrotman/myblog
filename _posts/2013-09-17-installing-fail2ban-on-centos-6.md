---
layout: post
title: Installing Fail2ban on Centos 6
date: '2013-09-17T14:46:00.003-04:00'
author: DatsWorld
tags:
- Security
- linux
- Centos
- Fail2Ban
modified_time: '2013-10-05T16:55:25.664-04:00'
blogger_id: tag:blogger.com,1999:blog-1770165193886521985.post-3123725537635147074
blogger_orig_url: http://blog.datsworld.com/2013/09/installing-fail2ban-on-centos-6.html
---

Fail2ban restricts&nbsp; IP addresses of hosts that are trying to breach your system's security. Whenever an abusive IP is detected it can&nbsp; restrict that IP access to your system for a specific period of time. This time is configurable by the administrator of the system. <br /><br /><br /><ol><li><h3><span style="color: #29aae1;">Download the latest version of fail2ban</span></h3></li><br /><pre class="pre1">[root@glt ~]# wget https://codeload.github.com/fail2ban/fail2ban/tar.gz/0.8.10</pre><br /><li><h3><span style="color: #29aae1;">Extract the files from the tar and run the "setup.py" script. </span></h3></li><br /><pre class="pre1">[root@glt ~]# tar -xf 0.8.10<br />[root@glt ~]# cd fail2ban-0.8.10<br />[root@glt fail2ban-0.8.10]# python setup.py install<br /></pre><li><h3><span style="color: #29aae1;">Configure fail2ban</span></h3></li><br /><pre class="pre1">[root@glt fail2ban-0.8.10]# vi /etc/fail2ban/jail.conf</pre><br /><ul><li><h5><span style="color: #29aae1;">White-list your IP address by adding it to the ignoreip line.</span></h5></li><blockquote class="style2">[DEFAULT]<br /># "ignoreip" can be an IP address, a CIDR mask or a DNS host. Fail2ban will not<br /># ban a host which matches an address in this list. Several addresses can be<br /># defined using space separator.<br /><b>ignoreip = 127.0.0.1</b></blockquote><li><h5><span style="color: #29aae1;">Configuring ssh-iptables section for Fail2Ban, remove false and type true. Also configure the email address that you would like&nbsp; to receive the alerts.</span></h5></li><blockquote class="style2">[ssh-iptables]<br /><br />enabled  = <b>true</b><br />filter   = sshd<br />action   = iptables[name=SSH, port=ssh, protocol=tcp]<br />sendmail-whois[name=SSH, dest=<b>you@example.com</b>,&nbsp; sender=<b>fail2ban@localhost</b>]<br />logpath  = /var/log/sshd.log<br />maxretry = 5</blockquote></ul><br /><li><h3><span style="color: #29aae1;">To ensure that fail2ban starts at startup.</span></h3></li><br /><pre class="pre1">[root@glt fail2ban-0.8.10]# cp ./files/redhat-initd /etc/init.d/fail2ban<br />[root@glt fail2ban-0.8.10]# chkconfig --add fail2ban<br />[root@glt fail2ban-0.8.10]# chkconfig fail2ban on<br /></pre><br /><li><h3><span style="color: #29aae1;">Start fail2ban.</span></h3><br /><pre class="pre1">[root@glt fail2ban-0.8.10]# service fail2ban start<br />Starting fail2ban:                                         [  OK  ]</pre></li><li><h3><span style="color: #29aae1;">Following list IP that was blocked by fail2ban</span></h3><br /><pre class="pre1">[root@glt ~]# iptables -L<br />Chain INPUT (policy ACCEPT)<br />target     prot opt source               destination<br />fail2ban-SSH  tcp  --  anywhere             anywhere            tcp dpt:ssh<br />ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED<br />DROP       icmp --  anywhere             anywhere            icmp echo-request<br />ACCEPT     all  --  anywhere             anywhere<br />ACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh<br />ACCEPT     tcp  --  192.168.0.0/24       anywhere            tcp dpt:http<br />ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:https<br />REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited<br /><br />Chain FORWARD (policy ACCEPT)<br />target     prot opt source               destination<br />REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited<br /><br />Chain OUTPUT (policy ACCEPT)<br />target     prot opt source               destination<br /><br />Chain fail2ban-SSH (1 references)<br />target     prot opt source               destination<br />REJECT     all  --  61.147.116.109       anywhere            reject-with icmp-port-unreachable<br />RETURN     all  --  anywhere             anywhere<br />[root@glt ~]#<br /></pre><br /> </li></ol>