---
layout: post
title: 'Host Based Intrusion Detection System: OSSEC'
date: '2013-09-21T12:10:00.001-04:00'
author: DatsWorld
tags:
- OSSEC
- Security
- linux
- Centos
modified_time: '2013-09-25T14:59:50.134-04:00'
blogger_id: tag:blogger.com,1999:blog-1770165193886521985.post-6547431488295543621
blogger_orig_url: http://blog.datsworld.com/2013/09/host-based-intrusion-detection-system.html
---

A host-based intrusion detection system (HIDS) is software that monitors and analyzes activities on a host looking for any suspicious processes.&nbsp; On Centos I chose to install <annotate title="Open Source SECurity">OSSEC</annotate>; as my <annotate title="Host-based Intrusion Detection System">HIDS</annotate>, the following is the method I used to install.<br /><br /><ol><li><h3><span style="color: #29aae1;">Install some stuff so we can compile <annotate title="Open Source SECurity">OSSEC</annotate> later.</span></h3></li><pre class="pre1">[root@glt ~]# yum -y install gcc gcc-c++ autoconf automake</pre><br /><li><h3><span style="color: #29aae1;">Download the latest version of <annotate title="Open Source SECurity">OSSEC</annotate>.</span></h3></li><br /><pre class="pre1">[root@glt ~]# wget http://www.ossec.net/files/ossec-hids-latest.tar.gz<br /></pre><br /><li><h3><span style="color: #29aae1;">Extract the files from the tar and run the "install.sh" script.</span></h3></li><br /><pre class="style1">[root@glt ~]# tar -zxvf ossec-hids-latest.tar.gz<br />[root@glt ~]# cd ossec-hids-2.7<br />[root@glt ossec-hids-2.7]# ./install.sh<br /></pre><br />When asked for what kind of installation options choose local. You can chose server if you plan on accepting logs from a remote agents. Accept default values for the remaining options.<br /><br /><li><h3><span style="color: #29aae1;">Start <annotate title="Open Source SECurity">OSSEC</annotate> <annotate title="Host-based Intrusion Detection System">HIDS</annotate></span></h3></li><br /><pre class="pre1">[root@glt ~]# /var/ossec/bin/ossec-control start<br /></pre><br /><br /><li><h3><span style="color: #29aae1;">Stop <annotate title="Open Source SECurity">OSSEC</annotate> <annotate title="Host-based Intrusion Detection System">HIDS</annotate></span></h3></li><br /><pre class="pre1">[root@glt ~]# /var/ossec/bin/ossec-control stop<br /></pre><br /></ol><h2 style="background-color: white; color: #29aae1; font-family: &quot;Segoe UI&quot;, Calibri, &quot;Myriad Pro&quot;, Myriad, &quot;Trebuchet MS&quot;, Helvetica, Arial, sans-serif; font-size: 26px; font-weight: normal; line-height: 28px; margin: 0.7em 0px 0.2em; padding: 0px;">Install <annotate title="Open Source SECurity">OSSEC</annotate> Web User Interface (<annotate title="Open Source SECurity">OSSEC</annotate> <annotate title="Web User Interface">WUI</annotate>)</h2><br /><ol><li><h3><span style="color: #29aae1;">Install Apache and PHP.</span></h3></li><br /><pre>[root@glt ~]# yum -y httpd php mod_ssl openssl<br />[root@glt ~]# chkconfig --levels 235 httpd on<br /></pre><br /><li><h3><span style="color: #29aae1;">Open the Apache configuration file.</span></h3></li><br /><pre class="pre1">[root@glt ossec]# vi /etc/httpd/conf/httpd.conf</pre><br /><li><h3><span style="color: #29aae1;">Change AllowOverride None to AllowOverride All inside the DocumentRoot Directory Directive.</span></h3></li><br /><blockquote class="style2">&lt;Directory "/var/www/html"&gt;<br />Options Indexes FollowSymLinks<br />AllowOverride All<br />Order allow,deny<br />Allow from all<br />&lt;/Directory&gt;</blockquote><br /><li><h3><span style="color: #29aae1;">Create a SSL Certificate on Apache for CentOS 6. To encrypt the site's information and create a more secure connection.</span></h3></li><br /><ul><li><h5><span style="color: #29aae1;">Generate private key</span></h5></li><br /><pre class="pre1">[root@glt ossec]# openssl genrsa -out ca.key 2048</pre><br /><li><h5><span style="color: #29aae1;"> Generate CSR</span></h5></li><br /><pre class="pre1">[root@glt ~]# openssl req -new -key ca.key -out ca.csr</pre><br /><li><h5><span style="color: #29aae1;">Generate Self Signed Key</span></h5></li><br /><pre class="pre1">[root@glt ~]# openssl x509 -req -days 365 -in ca.csr -signkey ca.key -out ca.crt</pre><br /><li><h5><span style="color: #29aae1;">Copy the files to the correct locations</span></h5></li><br /><pre class="pre1">[root@glt ~]# cp ca.crt /etc/pki/tls/certs/<br />[root@glt ~]# cp ca.key /etc/pki/tls/private/<br />[root@glt ~]# cp ca.csr /etc/pki/tls/private/<br /></pre><br /><li><h5><span style="color: #29aae1;">Set up the virtual hosts to display the new certificate.</span></h5></li><pre class="pre1">[root@glt ~]# vi /etc/httpd/conf.d/ssl.conf</pre><br /><li><h5><span style="color: #29aae1;">Find the following two lines, and make sure that they match the extensions below.</span></h5></li><br /><pre class="pre1">SSLCertificateFile /etc/pki/tls/certs/ca.crt<br />SSLCertificateKeyFile /etc/pki/tls/private/ca.key<br /></pre><br /></ul><br /><li><h3><span style="color: #29aae1;">Download the latest version of&nbsp;<annotate title="Open Source SECurity">OSSEC</annotate> web user interface.</span></h3></li><br /><pre class="pre1">[root@glt ~]# wget http://www.ossec.net/files/ossec-wui-0.3.tar.gz<br /></pre><br /><li><h3><span style="color: #29aae1;">Extract the files from the tar and move the folder to web-server root directory.</span></h3></li><br /><pre class="pre1">[root@glt ~]# tar -zxvf ossec-wui-0.3.tar.gz<br />[root@glt ~]# mv ossec-wui-0.3 /var/www/html/ossec<br /></pre><br /><li><h3><span style="color: #29aae1;">Run the setup.sh script&nbsp;</span></h3></li><br /><pre class="pre1">[root@glt ~]# cd /var/www/html/ossec/<br />[root@glt ossec]# ./setup.sh<br />Setting up ossec ui...<br /><br />Username: admin<br />New password:<br />Re-type new password:<br />Adding password for user admin<br /><br />Setup completed successfuly.<br /></pre><br /><li><h3><span style="color: #29aae1;">Add your web server user (apache) to the ossec group:</span></h3></li><br /><pre class="pre1">[root@glt ossec]# usermod -a -G ossec apache<br />[root@glt ossec]# chmod 770 tmp/<br />[root@glt ossec]# chgrp apache tmp/<br /></pre><br /><li><h3><span style="color: #29aae1;">Start apache:</span></h3></li><br /><pre class="pre1">[root@glt ossec]# /etc/init.d/httpd restart<br /></pre></ol>